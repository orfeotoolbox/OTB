/* SOLIRR.f -- translated by f2c (version 19970805).
   You must link the resulting object file with the libraries:
	-lf2c -lm   (in that order)
*/

#ifdef __cplusplus
extern "C" {
#endif
/* OTB patches: replace "f2c.h" by "otb_6S.h" */
/*#include "f2c.h"*/
#include "otb_6S.h"

/* Common Block Declarations */

Extern struct {
    integer iwr;
    logical ier;
} sixs_ier__;

#define sixs_ier__1 sixs_ier__

/*<       subroutine solirr (wl,swl) >*/
/* Subroutine */ int solirr_(doublereal *wl, doublereal *swl)
{
    /* Initialized data */

    static doublereal si[1501] = { 69.3,77.65,86.,100.06,114.12,137.06,160.,
	    169.52,179.04,178.02,177.,193.69,210.38,241.69,273.,318.42,363.84,
	    434.42,505.,531.5,558.,547.5,537.,559.02,581.03,619.52,658.,
	    694.39,730.78,774.39,817.99,871.99,925.99,912.04,898.09,920.69,
	    943.29,925.99,908.69,936.09,963.49,994.94,1026.39,980.74,935.09,
	    1036.29,1137.49,1163.74,1189.99,1109.34,1028.69,1088.99,1149.29,
	    1033.69,918.09,1031.89,1145.69,1035.09,924.49,1269.29,1614.09,
	    1631.09,1648.09,1677.19,1706.29,1744.89,1783.49,1750.19,1716.89,
	    1705.19,1693.49,1597.69,1501.89,1630.99,1760.09,1775.24,1790.39,
	    1859.94,1929.49,1993.44,2057.39,2039.23,2021.08,2030.73,2040.38,
	    2026.53,2012.68,1999.53,1986.38,2002.88,2019.38,2038.09,2056.79,
	    1967.74,1878.68,1905.83,1932.98,1953.58,1974.18,1935.68,1897.19,
	    1916.78,1936.38,1937.23,1938.09,1881.44,1824.79,1814.09,1803.39,
	    1832.24,1861.09,1885.93,1910.78,1904.68,1898.58,1875.73,1852.88,
	    1865.64,1878.39,1874.74,1871.09,1872.44,1873.79,1850.39,1826.99,
	    1837.04,1847.09,1841.18,1835.28,1849.48,1863.69,1851.03,1838.38,
	    1840.73,1843.08,1802.83,1762.58,1778.78,1794.99,1777.48,1759.98,
	    1764.73,1769.49,1753.48,1737.48,1713.14,1688.8,1702.88,1716.97,
	    1696.07,1675.17,1672.03,1668.89,1663.56,1658.23,1647.75,1637.27,
	    1630.02,1622.77,1606.06,1589.36,1552.29,1515.22,1528.91,1542.6,
	    1548.9,1555.21,1544.41,1533.62,1525.24,1516.86,1507.92,1498.98,
	    1484.07,1469.17,1464.28,1459.39,1448.73,1438.08,1423.16,1408.24,
	    1407.53,1406.82,1397.82,1388.82,1378.51,1368.21,1352.13,1336.05,
	    1343.88,1351.71,1339.6,1327.5,1320.72,1313.94,1294.94,1275.94,
	    1280.92,1285.9,1278.04,1270.19,1263.68,1257.18,1249.8,1242.41,
	    1231.3,1220.19,1212.14,1204.1,1201.69,1199.29,1194.78,1190.27,
	    1185.47,1180.68,1174.38,1168.09,1156.17,1144.26,1143.46,1142.67,
	    1132.95,1123.23,1116.71,1110.19,1110.89,1111.59,1094.8,1078.01,
	    1077.75,1077.49,1073.89,1070.29,1058.71,1047.13,1045.66,1044.2,
	    1037.03,1029.86,1010.4,990.94,966.91,942.89,972.87,1002.86,978.93,
	    955.,960.95,966.91,983.31,999.71,991.91,984.11,979.05,973.99,
	    968.79,963.6,958.23,952.87,947.93,942.99,937.99,933.,928.,923.,
	    918.18,913.37,908.74,904.11,899.05,893.99,889.18,884.37,879.74,
	    875.12,870.24,865.36,860.94,856.53,852.02,847.5,843.,838.5,833.99,
	    829.49,824.98,820.48,815.99,811.5,806.99,802.49,798.17,793.86,
	    789.74,785.63,781.25,776.87,772.92,768.98,764.8,760.63,756.06,
	    751.49,746.99,742.49,738.18,733.88,729.76,725.63,721.24,716.86,
	    712.92,708.99,704.81,700.63,696.25,691.87,687.94,684.01,680.01,
	    676.,671.8,667.61,663.23,658.86,655.32,651.77,649.07,646.37,
	    643.74,641.11,638.05,634.99,632.18,629.37,626.74,624.12,621.06,
	    618.,615.18,612.37,609.92,607.48,604.79,602.11,599.24,596.38,
	    593.93,591.48,588.79,586.11,583.25,580.4,577.94,575.48,572.99,
	    570.51,568.,565.49,562.98,560.47,557.98,555.5,553.01,550.51,548.,
	    545.49,542.98,540.48,537.98,535.49,533.19,530.9,528.94,526.99,
	    524.8,522.62,520.24,517.87,515.44,513.01,509.59,506.17,502.89,
	    499.62,496.35,493.09,489.81,486.54,483.27,480.01,476.73,473.46,
	    470.19,466.92,463.64,460.37,457.1,453.84,450.57,447.3,444.03,
	    440.76,437.48,434.21,430.94,427.67,424.4,421.13,417.86,414.59,
	    411.32,408.05,404.78,401.51,398.24,394.97,391.7,388.43,392.57,
	    396.71,401.92,407.14,405.32,403.5,401.67,399.84,398.02,396.21,
	    394.37,392.54,390.72,388.9,387.06,385.23,383.42,381.6,379.77,
	    377.95,376.12,374.3,372.48,370.66,368.82,366.99,365.17,363.35,
	    361.52,359.69,357.87,356.05,354.22,352.39,350.57,348.75,346.92,
	    345.1,343.27,341.45,341.84,342.24,342.95,343.66,342.27,340.89,
	    339.49,338.09,336.69,335.3,333.91,332.53,331.13,329.73,328.34,
	    326.96,325.56,324.16,322.77,321.39,319.99,318.59,317.2,315.82,
	    314.42,313.03,311.63,310.24,308.85,307.46,306.06,304.66,303.28,
	    301.9,300.5,299.1,297.71,296.32,294.93,293.54,293.41,293.28,
	    293.35,293.42,292.26,291.1,289.97,288.84,287.69,286.54,285.39,
	    284.25,283.1,281.96,280.81,279.67,278.52,277.38,276.23,275.08,
	    273.94,272.8,271.65,270.51,269.36,268.22,267.07,265.93,264.78,
	    263.64,262.49,261.34,260.2,259.06,257.91,256.77,255.62,254.47,
	    253.33,252.2,251.16,250.13,249.11,248.09,246.97,245.86,244.74,
	    243.61,242.49,241.37,240.24,239.12,238.,236.89,235.76,234.64,
	    233.51,232.38,231.26,230.13,229.01,227.9,226.77,225.65,224.53,
	    223.42,222.29,221.16,220.04,218.92,217.8,216.68,215.55,214.43,
	    213.3,212.18,211.06,209.94,208.82,207.69,206.99,206.29,205.65,
	    205.02,203.98,202.95,201.9,200.85,199.81,198.78,197.74,196.7,
	    195.65,194.61,193.57,192.54,191.5,190.47,189.42,188.37,187.33,
	    186.3,185.26,184.22,183.18,182.14,181.1,180.06,179.02,177.98,
	    176.93,175.89,174.86,173.83,172.78,171.73,170.7,169.67,168.62,
	    167.57,167.59,167.6,167.76,167.93,167.09,166.26,165.42,164.58,
	    163.75,162.92,162.08,161.25,160.41,159.58,158.74,157.91,157.07,
	    156.24,155.4,154.57,153.73,152.9,152.06,151.23,150.39,149.56,
	    148.72,147.89,147.06,146.23,145.39,144.55,143.71,142.88,142.05,
	    141.22,140.38,139.54,138.7,137.86,137.99,138.11,138.36,138.6,
	    137.94,137.29,136.64,136.,135.35,134.71,134.05,133.39,132.74,
	    132.09,131.45,130.81,130.15,129.49,128.84,128.2,127.55,126.9,
	    126.25,125.6,124.94,124.29,123.64,123.,122.35,121.7,121.05,120.4,
	    119.74,119.09,118.45,117.81,117.15,116.5,115.85,115.19,115.25,
	    115.31,115.46,115.62,115.11,114.6,114.09,113.58,113.06,112.54,
	    112.03,111.53,111.01,110.5,109.99,109.47,108.95,108.44,107.93,
	    107.42,106.92,106.42,105.89,105.37,104.85,104.34,103.83,103.33,
	    102.81,102.29,101.79,101.29,100.77,100.25,99.74,99.22,98.71,98.2,
	    97.69,97.18,97.12,97.07,97.09,97.11,96.68,96.26,95.84,95.42,94.99,
	    94.56,94.14,93.72,93.31,92.89,92.46,92.03,91.61,91.19,90.76,90.34,
	    89.92,89.49,89.07,88.66,88.24,87.81,87.39,86.97,86.55,86.12,85.69,
	    85.26,84.85,84.43,84.01,83.59,83.17,82.75,82.32,81.89,81.89,81.89,
	    81.95,82.02,81.68,81.35,81.,80.65,80.32,79.99,79.64,79.3,78.96,
	    78.61,78.27,77.94,77.6,77.26,76.91,76.57,76.24,75.9,75.56,75.22,
	    74.88,74.54,74.2,73.86,73.52,73.18,72.84,72.5,72.16,71.82,71.48,
	    71.14,70.8,70.47,70.13,69.79,69.76,69.73,69.76,69.8,69.52,69.24,
	    68.96,68.68,68.41,68.14,67.85,67.57,67.29,67.02,66.75,66.48,66.19,
	    65.9,65.63,65.36,65.08,64.8,64.53,64.25,63.97,63.69,63.41,63.14,
	    62.85,62.57,62.3,62.03,61.75,61.47,61.19,60.92,60.64,60.36,60.08,
	    59.81,59.8,59.8,59.82,59.85,59.63,59.4,59.17,58.95,58.73,58.5,
	    58.28,58.06,57.83,57.6,57.37,57.15,56.93,56.7,56.48,56.26,56.03,
	    55.79,55.57,55.36,55.13,54.9,54.66,54.43,54.22,54.,53.77,53.55,
	    53.32,53.09,52.87,52.65,52.43,52.2,51.97,51.75,51.72,51.68,51.67,
	    51.67,51.48,51.3,51.11,50.92,50.73,50.55,50.37,50.18,49.98,49.79,
	    49.61,49.43,49.23,49.04,48.85,48.67,48.48,48.3,48.12,47.93,47.73,
	    47.54,47.36,47.18,46.98,46.79,46.6,46.42,46.24,46.06,45.87,45.67,
	    45.48,45.3,45.12,44.93,44.87,44.82,44.8,44.79,44.62,44.45,44.29,
	    44.14,43.98,43.83,43.66,43.49,43.34,43.18,43.02,42.86,42.7,42.55,
	    42.38,42.21,42.06,41.9,41.74,41.58,41.42,41.26,41.1,40.94,40.78,
	    40.62,40.46,40.31,40.14,39.97,39.81,39.66,39.5,39.34,39.18,39.03,
	    38.99,38.96,38.94,38.92,38.79,38.66,38.52,38.38,38.25,38.12,37.99,
	    37.86,37.72,37.58,37.44,37.3,37.17,37.05,36.91,36.77,36.64,36.5,
	    36.36,36.23,36.09,35.96,35.82,35.69,35.55,35.42,35.28,35.15,35.01,
	    34.88,34.75,34.61,34.47,34.34,34.2,34.07,34.05,34.03,34.03,34.03,
	    33.91,33.79,33.68,33.57,33.46,33.35,33.23,33.12,33.01,32.9,32.78,
	    32.67,32.55,32.44,32.33,32.23,32.11,32.,31.89,31.77,31.66,31.55,
	    31.43,31.31,31.2,31.1,30.99,30.87,30.76,30.66,30.54,30.42,30.31,
	    30.2,30.08,29.97,29.93,29.9,29.88,29.87,29.76,29.66,29.56,29.46,
	    29.36,29.27,29.17,29.08,28.98,28.88,28.77,28.67,28.58,28.49,28.39,
	    28.3,28.2,28.1,28.,27.91,27.81,27.71,27.61,27.52,27.41,27.31,
	    27.21,27.12,27.03,26.93,26.83,26.74,26.64,26.54,26.44,26.35,26.33,
	    26.31,26.29,26.28,26.2,26.12,26.04,25.95,25.87,25.79,25.71,25.64,
	    25.54,25.45,25.37,25.3,25.21,25.12,25.05,24.98,24.89,24.8,24.71,
	    24.63,24.55,24.47,24.39,24.31,24.22,24.14,24.05,23.97,23.89,23.81,
	    23.73,23.66,23.56,23.47,23.39,23.31,23.28,23.26,23.23,23.21,23.13,
	    23.06,22.99,22.92,22.84,22.76,22.69,22.63,22.55,22.47,22.41,22.35,
	    22.27,22.19,22.11,22.04,21.97,21.9,21.83,21.76,21.68,21.6,21.53,
	    21.47,21.39,21.31,21.24,21.18,21.11,21.03,20.96,20.89,20.81,20.73,
	    20.66,20.6,20.57,20.55,20.54,20.53,20.46,20.4,20.34,20.28,20.21,
	    20.14,20.08,20.03,19.96,19.9,19.83,19.77,19.71,19.65,19.59,19.53,
	    19.46,19.39,19.33,19.27,19.21,19.15,19.08,19.02,18.96,18.9,18.84,
	    18.78,18.71,18.64,18.58,18.53,18.46,18.4,18.33,18.27,18.26,18.25,
	    18.24,18.24,18.19,18.14,18.08,18.03,17.98,17.93,17.88,17.83,17.77,
	    17.71,17.66,17.62,17.56,17.5,17.45,17.41,17.35,17.29,17.25,17.21,
	    17.14,17.08,17.04,17.,16.93,16.87,16.83,16.79,16.72,16.66,16.61,
	    16.57,16.51,16.46,16.41,16.36,16.34,16.33,16.31,16.3,16.26,16.22,
	    16.17,16.13,16.08,16.04,16.,15.96,15.9,15.84,15.81,15.78,15.73,
	    15.68,15.63,15.59,15.55,15.5,15.45,15.4,15.36,15.32,15.28,15.24,
	    15.18,15.13,15.09,15.05,15.01,14.96,14.91,14.87,14.82,14.78,14.73,
	    14.69,14.66,14.64,14.64,14.63,14.59,14.55,14.5,14.45,14.41,14.38,
	    14.35,14.32,14.26,14.21,14.18,14.15,14.1,14.05,14.01,13.98,13.94,
	    13.91,13.86,13.82,13.78,13.74,13.7,13.67,13.62,13.58,13.54,13.5,
	    13.46,13.43,13.39,13.35,13.3,13.25,13.22,13.18,13.17,13.16,13.14,
	    13.12,13.09,13.06,13.03,13.,12.96,12.92,12.89,12.85,12.81,12.78,
	    12.74,12.7,12.67,12.65,12.61,12.57,12.53,12.5,12.46,12.43,12.39,
	    12.36,12.32,12.28,12.25,12.22,12.18,12.15,12.11,12.07,12.04,12.01,
	    11.97,11.94,11.9,11.86,11.85,11.85,11.85,11.84,11.81,11.78,11.75,
	    11.72,11.69,11.66,11.63,11.6,11.58,11.55,11.51,11.47,11.45,11.42,
	    11.39,11.36,11.33,11.3,11.27,11.24,11.21,11.18,11.15,11.12,11.09,
	    11.06,11.03,11.,10.97,10.94,10.91,10.89,10.85,10.82,10.78,10.75,
	    10.73,10.72,10.71,10.7,10.67,10.64,10.62,10.59,10.55,10.52,10.5,
	    10.47,10.44,10.42,10.39,10.37,10.34,10.31,10.28,10.25,10.22,10.2,
	    10.17,10.15,10.12,10.1,10.06,10.03,10.,9.98,9.95,9.92,9.89,9.86,
	    9.84,9.82,9.79,9.75,9.73,9.71,9.7,9.7,9.7,9.7,9.67,9.63,9.61,9.59,
	    9.58,9.56,9.53,9.5,9.48,9.45,9.43,9.41,9.39,9.36,9.34,9.32,9.3,
	    9.27,9.24,9.22,9.2,9.18,9.15,9.13,9.11,9.08,9.06,9.05,9.02,8.99,
	    8.96,8.94,8.92,8.9,8.87,8.85,8.83,8.81 };

    /* Format strings */
    static char fmt_20[] = "(\002      wavelength  less  than  0.25  micron \
 :\002,/,\002let's take s(l)=s(0.25)\002)";

    /* Builtin functions */
    integer s_wsfe(cilist *), e_wsfe();

    /* Local variables */
    doublereal pas;
    integer iwl;

    /* Fortran I/O blocks */
    static cilist io___4 = { 0, 0, 0, fmt_20, 0 };


/*     si (in w/m2/micron) contains the values of the solar */
/*     irradiance between 0.25 and 4.0 microns, by step of 0.0025 m. */
/*     the value of the total irradiance is 1372 w/m2 on the whole */
/*     spectrum (1358 w/m2 between 0.25 and 4.0 microns) */

/*<       dimension si(1501) >*/
/*<       logical ier >*/
/*<       real wl,swl,si,pas >*/
/*<       integer iwr,i,iwl >*/
/*<       common/sixs_ier/iwr,ier >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<    >*/
/*<       pas=0.0025 >*/
    pas = .0025;
/*<       iwl=(wl-0.250)/pas+1.5 >*/
    iwl = (integer) ((*wl - .25) / pas + 1.5);
/*<       if(iwl.lt.0) goto 10 >*/
    if (iwl < 0) {
	goto L10;
    }
/*<       swl=si(iwl) >*/
    *swl = si[iwl - 1];
/*<       return >*/
    return 0;
/*< 10    write(iwr, 20) >*/
L10:
    io___4.ciunit = sixs_ier__1.iwr;
    s_wsfe(&io___4);
    e_wsfe();
/*<       swl=si(1) >*/
    *swl = si[0];
/*< 20 >*/
/*<       return >*/
    return 0;
/*<       end >*/
} /* solirr_ */

#ifdef __cplusplus
	}
#endif
